- name: System Configuration Tasks
  tags: system
  become: true
  block:
    - name: Debian_Package Installation
      ansible.builtin.include_tasks: packages_deb.yml
      when: enable_packages and ansible_facts['os_family'] == "Debian"

    - name: Just Installation
      ansible.builtin.include_tasks: just.yml
      when: enable_packages and ansible_facts['os_family'] == "Debian"

    - name: System SSH Config
      ansible.builtin.include_tasks: ssh.yml
      when: enable_ssh_config

    - name: UFW Firewall Configuration
      ansible.builtin.include_tasks: firewall.yml
      when: enable_ufw_config and ansible_facts['distribution'] == "Ubuntu"

    - name: Environment Variable Config
      ansible.builtin.include_tasks: env.yml
      when: enable_env_config

    - name: MOTD Population
      ansible.builtin.include_tasks: motd.yml
      when: enable_motd_config

    - name: NAS NFS Configuration
      ansible.builtin.include_tasks: nfs_mounts.yml
      when: nfs is defined

    - name: CheckMK Agent Installation
      ansible.builtin.include_tasks: checkmk_agent.yml
      when: global_system_checkmk_install

    - name: Misc Tasks
      ansible.builtin.include_tasks: misc.yml
      when: enable_misc_config
